<!DOCTYPE html>
<html>
<head>
<title>OpenID Connect Example</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

        h1 {
        color: #2c3e50;
        margin-bottom: 20px;
    }

        h2 {
        color: #3498db;
        margin-top: 30px;
        margin-bottom: 15px;
    }

        .card {
        background-color: #f9f9f9;
        border: 1px solid #eee;
        border-radius: 6px;
        padding: 20px;
        margin: 20px 0;
    }

        .btn {
        display: inline-block;
        background-color: #3498db;
        color: white;
        padding: 10px 15px;
        text-decoration: none;
        border-radius: 4px;
        font-weight: 500;
        margin-top: 10px;
    }

        .btn-logout {
        background-color: #e74c3c;
    }

        .btn:hover {
        opacity: 0.9;
    }

        pre {
        background-color: #f5f5f5;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
        font-size: 14px;
        line-height: 1.4;
    }

        .user-info {
        margin-top: 20px;
    }

        .user-info-item {
        margin-bottom: 10px;
    }

        .user-info-label {
        font-weight: bold;
        display: inline-block;
        width: 100px;
    }

        .token-section {
        margin-top: 30px;
    }

        .token-label {
        font-weight: bold;
        margin-bottom: 5px;
    }

        .token-value {
        word-break: break-all;
        font-family: monospace;
        font-size: 12px;
        padding: 10px;
        background-color: #f5f5f5;
        border-radius: 4px;
        margin-bottom: 15px;
    }
    </style>
</head>
<body>
<h1>OpenID Connect Example</h1>

<% if (isAuthenticated) { %>
    <div class="card">
    <h2>You are logged in!</h2>
    <p>You have successfully authenticated using OpenID Connect.</p>

    <div class="user-info">
    <h3>User Information:</h3>
    <% if (userInfo) { %>
    <div class="user-info-item">
    <span class="user-info-label">ID:</span>
    <span><%= userInfo.sub %></span>
    </div>
    <% if (userInfo.email) { %>
    <div class="user-info-item">
    <span class="user-info-label">Email:</span>
    <span><%= userInfo.email %></span>
    </div>
    <% } %>
    <% if (userInfo.name) { %>
    <div class="user-info-item">
    <span class="user-info-label">Name:</span>
    <span><%= userInfo.name %></span>
    </div>
    <% } %>
    <% } else { %>
    <p>No user info available.</p>
    <% } %>
    </div>

    <div class="token-section">
    <h3>Tokens:</h3>

    <div class="token-label">Access Token:</div>
    <div class="token-value"><%= accessToken %></div>

    <% if (idToken) { %>
    <div class="token-label">ID Token:</div>
    <div class="token-value"><%= idToken %></div>
    <% } %>
    </div>

    <a href="/logout" class="btn btn-logout">Logout</a>
    </div>
    <% } else { %>
    <div class="card">
    <h2>Authentication Demo</h2>
    <p>This example demonstrates OpenID Connect authentication. Click the button below to start the login process.</p>
    <p>You will see the consent page where you can approve the requested scopes.</p>
    <a href="/login" class="btn">Login with OpenID Connect</a>
    </div>

    <div class="card">
    <h2>What happens during authentication?</h2>
    <ol>
    <li>You'll be redirected to the authorization server</li>
    <li>You'll authenticate with your credentials</li>
    <li>You'll see a consent page asking for permission</li>
    <li>After approving, you'll be redirected back here</li>
    <li>The app will receive your user information</li>
    </ol>
    </div>
    <% } %>

    <div class="card">
    <h2>About OpenID Connect</h2>
    <p>OpenID Connect is an identity layer on top of the OAuth 2.0 protocol. It allows clients to verify the identity of the end-user and to obtain basic profile information in an interoperable and REST-like manner.</p>
    <p>OpenID Connect extends OAuth 2.0 by adding:</p>
    <ul>
    <li>ID Token - a JWT containing user identity information</li>
    <li>UserInfo Endpoint - to fetch additional user details</li>
    <li>Standard set of scopes for user information</li>
    <li>Standardized implementation</li>
    </ul>
    </div>
    </body>
    </html>